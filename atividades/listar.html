{% extends "base.html" %}
{% block title %}Atividades{% endblock %}

{% block content %}

<style>
  /* ===== SOLUÃ‡ÃƒO DEFINITIVA (SEM CLIP-PATH) ===== */

  .atividades-card {
    background: #111827;                 /* fundo vem do CARD */
    border: 1px solid #1f2937;
    border-radius: 14px;
    overflow: hidden;                    /* ðŸ”¥ corte REAL */
  }

  /* remove fundos prÃ³prios da tabela */
  .atividades-card table,
  .atividades-card thead,
  .atividades-card tbody,
  .atividades-card tr,
  .atividades-card th,
  .atividades-card td {
    background-color: transparent !important;
  }

  .atividades-card th {
    color: #9ca3af;
    font-weight: 600;
  }

  .atividades-card td {
    color: #e5e7eb;
  }

  .atividades-card tbody tr:hover {
    background: rgba(255,255,255,0.04);
  }
</style>

<div class="container py-4">

  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="mb-0">Atividades</h3>

    <a href="{{ url_for('atividades.novo') }}" class="btn btn-primary">
      <i class="bi bi-plus-circle me-1"></i> Nova Atividade
    </a>
  </div>

  <form class="mb-3" method="get">
    <div class="input-group">
      <input name="q" class="form-control" placeholder="Buscar..." value="{{ request.args.get('q','') }}">
      <button class="btn btn-outline-light">Buscar</button>
    </div>
  </form>

  <!-- âœ… CARD CORRETO -->
  <div class="card atividades-card">
    <div class="card-body p-0">

      <div class="table-responsive">
        <!-- âŒ SEM table-dark -->
        <table class="table align-middle mb-0">
          <thead>
            <tr>
              <th>TÃ­tulo</th>
              <th>Aluno</th>
              <th style="width:140px">Data</th>
              <th>ConteÃºdo</th>
              <th class="text-center" style="width:120px">WhatsApp</th>
              <th class="text-end" style="width:140px">AÃ§Ãµes</th>
            </tr>
          </thead>

          <tbody>
            {% for it in itens %}
              <tr>
                <td class="fw-semibold">{{ it.nome }}</td>
                <td>{{ it.aluno_nome or 'â€”' }}</td>
                <td class="text-secondary">
                  {{ it.data_atividade.strftime('%d/%m/%Y') if it.data_atividade else 'â€”' }}
                </td>
                <td class="text-truncate" style="max-width:260px;">
                  {{ it.conteudo or 'â€”' }}
                </td>

                <td class="text-center">
                  {% set w = wa_link(it) %}
                  {% if w %}
                    <a class="btn btn-success btn-sm"
                       href="{{ w }}" target="_blank" rel="noopener">
                      <i class="bi bi-whatsapp"></i>
                    </a>
                  {% else %}
                    <span class="text-secondary small">â€”</span>
                  {% endif %}
                </td>

                <td class="text-end">
                  <div class="btn-group btn-group-sm">
                    <a href="{{ url_for('atividades.editar', id=it.id) }}"
                       class="btn btn-outline-light">
                      <i class="bi bi-pencil-square"></i>
                    </a>

                    <form method="post"
                          action="{{ url_for('atividades.excluir', id=it.id) }}"
                          onsubmit="return confirm('Excluir esta atividade?');">
                      <button class="btn btn-outline-danger">
                        <i class="bi bi-trash"></i>
                      </button>
                    </form>
                  </div>
                </td>
              </tr>
            {% else %}
              <tr>
                <td colspan="6" class="text-center text-secondary py-4">
                  Nenhuma atividade cadastrada.
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

    </div>
  </div>

</div>

{% endblock %}
