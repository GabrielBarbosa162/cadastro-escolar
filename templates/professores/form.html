{% extends "base.html" %}
{% block title %}{{ 'Editar Professor' if item else 'Novo Professor' }}{% endblock %}

{% block content %}
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="mb-0">{{ 'Editar Professor' if item else 'Novo Professor' }}</h3>
    <a href="{{ url_for('professores_listar') }}" class="btn btn-outline-light btn-sm">Voltar</a>
  </div>

  <div class="card">
    <div class="card-body">
      <form method="post" class="row g-3" autocomplete="off">

        <div class="col-12 col-md-6">
          <label class="form-label">E-mail (já cadastrado no sistema)</label>
          <input
            name="email"
            type="email"
            class="form-control"
            required
            placeholder="ex: professor@escola.com"
            value="{{ item.usuario.email if item and item.usuario else '' }}"
          >
          <small class="text-secondary">O e-mail precisa existir em Usuários.</small>
        </div>

        <div class="col-12 col-md-6">
          <label class="form-label">Nome</label>
          <input name="nome" class="form-control" required value="{{ item.nome if item else '' }}">
        </div>

        <div class="col-12 col-md-4">
          <label class="form-label">Data de nascimento</label>
          <input type="date" name="data_nascimento" class="form-control"
                 value="{{ item.data_nascimento.strftime('%Y-%m-%d') if item and item.data_nascimento else '' }}">
        </div>

        <div class="col-12">
          <label class="form-label">Séries responsáveis</label>

          {% set selecionadas = (item.series | map(attribute='id') | list) if item else [] %}

          <div class="card mt-1">
            <div class="card-body p-3">

              <div class="row g-2">
                {% for s in series %}
                  <div class="col-6 col-md-4 col-lg-3">
                    <input
                      class="btn-check"
                      type="checkbox"
                      name="series_ids"
                      value="{{ s.id }}"
                      id="serie_{{ s.id }}"
                      {% if s.id in selecionadas %}checked{% endif %}
                    >
                    <label class="btn btn-outline-light w-100 text-start" for="serie_{{ s.id }}">
                      {{ s.nome }}
                    </label>
                  </div>
                {% endfor %}
              </div>

              {% if not series %}
                <div class="text-secondary">Nenhuma série cadastrada.</div>
              {% endif %}
            </div>
          </div>

          <small class="text-secondary">Clique para marcar/desmarcar (não precisa Ctrl).</small>
        </div>

        <div class="col-12 text-end">
          <button class="btn btn-light">Salvar</button>
        </div>

      </form>
    </div>
  </div>
</div>
{% endblock %}
